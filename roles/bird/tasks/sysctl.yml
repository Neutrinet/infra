---

- name: Appliquer immédiatement les paramètres sysctl
  ansible.posix.sysctl:
    name: "{{ item.name }}"
    value: "{{ item.value }}"
    sysctl_file: /etc/sysctl.d/85-forward.conf
    sysctl_set: true
    state: present
    reload: true
  loop:
    - { name: 'net.ipv4.conf.all.rp_filter', value: '0' }
    - { name: 'net.ipv4.conf.default.rp_filter', value: '0' }
    - { name: 'net.ipv4.route.max_size', value: '4194304' }
    - { name: 'net.ipv6.route.max_size', value: '1048576' }
    - { name: 'net.ipv4.tcp_keepalive_time', value: '60' }
    - { name: 'net.ipv4.tcp_keepalive_intvl', value: '10' }
    - { name: 'net.ipv4.tcp_keepalive_probes', value: '6' }
    - { name: 'net.ipv4.route.gc_timeout', value: '100' }
    - { name: 'net.ipv6.route.gc_timeout', value: '100' }
    - { name: 'net.ipv4.tcp_l3mdev_accept', value: '1' }
    - { name: 'net.ipv4.udp_l3mdev_accept', value: '1' }
