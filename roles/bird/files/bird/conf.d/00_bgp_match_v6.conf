function match_rtbh_v6(string direction; string locality; int AS)
{

 if direction = "import" then {
  if (bgp_community ~ [(65535, 666)]) then {
    if (net.len = 128) then {
      dest = RTD_BLACKHOLE;
      bgp_local_pref = 900;

      print "[", direction, "][", locality, "] RTBH: Add to blackhole: ", net, " ", bgp_path;
      return true;
    }
    else {
      print "[", direction, "][", locality, "] Reject: Invalid mask to blackhole: ", net, " ", bgp_path;
      return false;
    }
  }
 }

 if direction = "export" && (bgp_community ~ [(65535, 666)]) then {
   bgp_community.delete((65535, 666));

    case AS {
      6696: bgp_community.add((6696, 666));
      35137: bgp_community.add((65535, 666));
      else: return false;
    }

    return true;
 }

 return false;
}
