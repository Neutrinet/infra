{{ ansible_managed | comment }}

http://{{ web_app_domain }} {
    root * {{ web_app_dist_dir | to_json }}
    encode zstd gzip
    file_server

    php_fastcgi unix/{{ php_fpm_socket_file }} {
        trusted_proxies {{ caddy_trusted_proxies | join(' ') }}
    }

    @phpFile {
        path *.php*
    }
    error @phpFile "Not found" 404

    log {
        output file {{ web_app_caddy_log | to_json }}
    }
}
