{{ ansible_managed | comment }}

<<: !include /etc/borgmatic/template.yml

location:
  source_directories:
    - "/etc/caddy/conf.d/{{ web_app_owner }}.conf"
    - "{{ web_app_dist_dir }}"
    - "{{ php_fpm_pool_dir }}/{{ web_app_owner }}.conf"

storage:
  archive_name_format: nextcloud-{{ web_app_owner }}_{hostname}-{now}

retention:
  prefix: nextcloud-{{ web_app_owner }}_

consistency:
  prefix: nextcloud-{{ web_app_owner }}_

hooks:
  postgresql_databases:
    - name: "{{ postgresql_db_name }}"
      username: "{{ postgresql_db_name }}"
      password: {{ postgresql_db_password | string | to_json }}
      hostname: "{{ postgresql_host }}"
