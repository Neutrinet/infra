letsencrypt_dns_gandi_api_key: "{{ vault_dns_gandi_api_key }}"
letsencrypt_dns_gandi_sharing_id: "{{ vault_dns_gandi_sharing_id }}"
letsencrypt_staging: false
letsencrypt_domains_gandi:
  - neutrinet.be
  - labriqueinter.net
  - internetcu.be

haproxy:
  - hostname: neutrinet.be
    target:
      - grav.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck

  - hostname: mediawiki.neutrinet.be
    target:
      - web-static.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck

  - hostname: wikijs.neutrinet.be
    target:
      - web-static.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck

  - hostname: realms-wiki.neutrinet.be
    target:
      - web-static.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck

  - hostname: chat.neutrinet.be
    target:
      - web.patata.louise.neutri.net
    target_port: 8065
    healthcheck: true
    healthcheck_url: GET /api/v4/system/ping

  - hostname: cube.neutrinet.be
    target:
      - web.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: HEAD /
    timeout: 2m

  - hostname: ffdnapi.neutrinet.be
    target:
      - web.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: HEAD /

  - hostname: files.neutrinet.be
    target:
      - web.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: HEAD /

  - hostname: user.neutrinet.be
    target:
      - web.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: HEAD /

  - hostname: wiki.neutrinet.be
    target:
      - dokuwiki.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck

  - hostname: meta.neutrinet.be
    target:
      - meta.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: HEAD /

  - hostname: s3.neutrinet.be
    target:
      - ceph-s3-01.patata.louise.neutri.net
      - ceph-s3-02.patata.louise.neutri.net
      - ceph-s3-03.patata.louise.neutri.net
    target_port: 7480
    healthcheck: true
    healthcheck_url: HEAD /

  - hostname: librenms.neutrinet.be
    target:
      - librenms.patata.louise.neutri.net
    target_port: 80
    healthcheck: false

  - hostname: doc.neutrinet.be
    target:
      - hedgedoc.patata.louise.neutri.net
    target_port: 3000
    healthcheck: true
    healthcheck_url: "HEAD /status"

  - hostname: wiki.labriqueinter.net
    target:
      - web-static.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck

haproxy_redirect:
  - from: www.neutrinet.be
    to: neutrinet.be
  - from: beta-wiki.neutrinet.be
    to: wiki.neutrinet.be
  - from: wiki-old.neutrinet.be
    to: mediawiki.neutrinet.be
  - from: admin.neutrinet.be
    to: cube.neutrinet.be
  - from: vpn.neutrinet.be
    to: api.neutrinet.be
  - from: wiki.internetcu.be
    to: wiki.labriqueinter.net

keepalived_interface: ens18
keepalived_vrrp_scripts:
  - name: check_haproxy
    cmd: /usr/bin/killall -0 haproxy

keepalived_instances:
  - vip: 10.0.11.10/32
    addresses:
      - 10.0.11.11
      - 10.0.11.12
    type: ipv4
  - vip: 2001:913:1000:11::10/128
    addresses:
      - 2001:913:1000:11::11
      - 2001:913:1000:11::12
    type: ipv6

haproxy_listen:
  - "127.0.0.1"
  - "10.0.11.10"
  - "[::1]"
  - "[2001:913:1000:11::10]"
