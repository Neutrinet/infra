letsencrypt_domains_ovh:
  - name: neutrinet.be
    wildcard: true
  - name: labriqueinter.net
    wildcard: true
  - name: internetcu.be
    wildcard: true
  - name: teamrecup.be
    wildcard: true
  - name: teamrecup.be
    wildcard: true

haproxy:
  - hostname: neutrinet.be
    target:
      - grav.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self' data: https:; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; font-src 'self'; connect-src 'self';"

  - hostname: beta.neutrinet.be
    target:
      - grav.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    users:
      - username: neutrinet
        password: neutrinet

    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self' data: https:; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; font-src 'self'; connect-src 'self';"

  - hostname: teamrecup.be
    target:
      - grav.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self' data: https:; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; font-src 'self'; connect-src 'self';"

  - hostname: mediawiki.neutrinet.be
    target:
      - web-static.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self' data: https:; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; font-src 'self';"

  - hostname: wikijs.neutrinet.be
    target:
      - web-static.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    headers:
      Content-Security-Policy: "default-src 'self'; img-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; font-src 'self';"

  - hostname: realms-wiki.neutrinet.be
    target:
      - web-static.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https:; font-src 'self' https:;"

  - hostname: chat.neutrinet.be
    target:
      - mattermost.patata.louise.neutri.net
    target_port: 8065
    healthcheck: true
    healthcheck_url: GET /api/v4/system/ping

  - hostname: accounting.neutrinet.be
    target:
      - accounting.patata.louise.neutri.net
    target_port: 3000
    healthcheck: true
    healthcheck_url: HEAD /
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self'; script-src 'self'; style-src 'self'; font-src 'self';"

  - hostname: cube.neutrinet.be
    target:
      - backoffice.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    timeout: 2m
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; font-src 'self';"

  - hostname: ffdnapi.neutrinet.be
    target:
      - backoffice.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self'; script-src 'self'; style-src 'self'; font-src 'self';"

  - hostname: files.neutrinet.be
    target:
      - nextcloud.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    timeout: 10m

  - hostname: user.neutrinet.be
    target:
      - web-static.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    headers:
      Content-Security-Policy: "default-src 'self' https://api.neutrinet.be; img-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline' https:; font-src 'self' https:;"

  - hostname: wiki.neutrinet.be
    target:
      - dokuwiki.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self' data: https:; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; font-src 'self'; connect-src 'self';"

  - hostname: mobilizon.be
    target:
      - mobilizon.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck

  - hostname: meta.neutrinet.be
    target:
      - meta.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: HEAD /

  - hostname: s3.neutrinet.be
    target:
      - topi.louise.neutri.net
      - nam.louise.neutri.net
      - bour.louise.neutri.net
    target_port: 7480
    healthcheck: true
    healthcheck_url: HEAD /
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self'; script-src 'self'; style-src 'self'; font-src 'self';"

  - hostname: librenms.neutrinet.be
    target:
      - librenms.patata.louise.neutri.net
    target_port: 80
    healthcheck: false
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; font-src 'self'; connect-src 'self';"

  - hostname: doc.neutrinet.be
    target:
      - hedgedoc.patata.louise.neutri.net
    target_port: 3000
    deny_paths:
      - /metrics
    healthcheck: true
    healthcheck_url: "HEAD /status"

  - hostname: support.neutrinet.be
    target:
      - zammad.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: "HEAD /healthcheck"

  - hostname: wiki.labriqueinter.net
    target:
      - web-static.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self'; script-src 'self'; style-src 'self'; font-src 'self';"

  - hostname: labriqueinter.net
    target:
      - web-static.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; font-src 'self'; media-src 'self'; frame-src 'self' https://db.ffdn.org;"

  - hostname: internetcu.be
    target:
      - web-static.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; font-src 'self'; media-src 'self'; frame-src 'self' https://db.ffdn.org;"

  - hostname: cfacile.labriqueinter.net
    target:
      - web-static.patata.louise.neutri.net
    target_port: 80
    healthcheck: true
    healthcheck_url: GET /healthcheck
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self'; media-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self'; font-src 'self';"

  - hostname: sync.labriqueinter.net
    target:
      - web-static.patata.louise.neutri.net
    target_port: 9000
    healthcheck: true
    healthcheck_url: HEAD /
    headers:
      Content-Security-Policy: "default-src 'none'; img-src 'self'; script-src 'self'; style-src 'self'; font-src 'self';"

  - hostname: collectd.neutrinet.be
    target:
      - collectd.patata.louise.neutri.net
    target_port: 9103
    healthcheck: true
    healthcheck_url: HEAD /
    users:
      - username: test
        password: neutrinet
      - username: "{{ vault_username_collectd_occupation_01 }}"
        password: "{{ vault_password_collectd_occupation_01 }}"
      - username: "{{ vault_username_collectd_occupation_02 }}"
        password: "{{ vault_password_collectd_occupation_02 }}"

  - hostname: stalwart.neutrinet.be
    alt_hostnames:
      - autoconfig.mobilizon.be
      - autodiscover.mobilizon.be
      - mta-sts.mobilizon.be
      - mail.mobilizon.be
      - autoconfig.neutri.net
      - autodiscover.neutri.net
      - mta-sts.neutri.net
      - mail.neutri.be
      - autoconfig.neutrinet.be
      - autodiscover.neutrinet.be
      - mta-sts.neutrinet.be
      - mail.neutrinet.be
      - autoconfig.teamrecup.be
      - autodiscover.teamrecup.be
      - mta-sts.teamrecup.be
      - mail.teamrecup.be
    target:
      - smtp.neutri.net
    target_port: 8080
    healthcheck: true
    healthcheck_url: GET /healthz/ready
    deny_paths:
      - /metrics

haproxy_redirect:
  - from: www.neutrinet.be
    to: neutrinet.be
  - from: beta-wiki.neutrinet.be
    to: wiki.neutrinet.be
  - from: wiki-old.neutrinet.be
    to: mediawiki.neutrinet.be
  - from: admin.neutrinet.be
    to: cube.neutrinet.be
  - from: vpn.neutrinet.be
    to: api.neutrinet.be
  - from: wiki.internetcu.be
    to: wiki.labriqueinter.net
  - from: www.labriqueinter.net
    to: labriqueinter.net
  - from: www.internetcu.be
    to: internetcu.be

haproxy_postgresql:
  - pgsql-01.patata.louise.neutri.net
  - pgsql-02.patata.louise.neutri.net
  - pgsql-03.patata.louise.neutri.net

haproxy_listen:
  - "127.0.0.1"
  - "10.0.11.10"
  - "[::1]"
  - "[2001:913:1000:11::10]"
